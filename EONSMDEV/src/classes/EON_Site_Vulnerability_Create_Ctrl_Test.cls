/**
    Description : This test class is used to cover the below classes.
            1. EON_Site_Vulnerability_Create_Ctrl_Test
            2. EON_Site_Vul_Handler
**/
/*
    Created By : Praveen G
    Created Date : 25/04/2017
    Service Request : SR_EON_PC_105
*/
@isTest
public class EON_Site_Vulnerability_Create_Ctrl_Test{

    /**
        unitTest1() - unittest1
    **/
    public static testmethod void unitTet1(){
        EON_Region__c region = new EON_Region__c(GSP_ID__c =12);        
        insert region;
        EON_Shutdown_Days__c days = new EON_Shutdown_Days__c(Name='Bank holiday',Holiday_Date__c=System.today());
        insert days;
        EON_Customer__c eCust = EON_CreateTestRecords.createEONCustomer();
        insert eCust;
        EON_Site__c eSite =  new EON_Site__c(Customer__c=eCust.ID, Name = '1234567890',
                            Building_Name__c = 'Able Smith House',Building_Number__c = '1324654',
                            Address_Type__c = 'S',Country__c = null ,County__c = null,
                            Dependant_Locality__c = 'Stevenage',Dependant_Thorofare__c = 'Stevenage',
                            Double_Dependant_Locality__c = 'Stevenage',Sub_Building_Name__c = 'Stevenage',
                            Thorofare__c = 'Stevenage',Town__c = 'Stevenage');
        insert eSite;   
        
        EON_Vulnerability_Code__c code = new EON_Vulnerability_Code__c();
        code.Name = 'TEST';
        insert code;        
        
        EON_Site_Vulnerability__c siteVul = new EON_Site_Vulnerability__c();
        siteVul.Premise__c = eSite.id; 
        siteVul.Vulnerability_Type__c = 'C';
        siteVul.Vulnerability_code__c = code.id;
        //insert siteVul;
        

        
        ApexPages.currentPage().getParameters().put('siteID', eSite.id);
        ApexPages.StandardController sc = new ApexPages.StandardController(siteVul);
        
        EON_Site_Vulnerability_Create_Ctrl ctrl = new EON_Site_Vulnerability_Create_Ctrl(sc);
        ctrl.getVulnerabilitycodes();
        ctrl.gotoSite();
        ctrl.getVCodes();
        ctrl.saveRec();
      
        
        ctrl.selectedVType = 'TEST123';
        ctrl.selectedVCode = code.id;
        ctrl.saveRec();
        
        ctrl.selectedVType = 'C';
        ctrl.selectedVCode = code.id;
        System.assert(ctrl.saveRec() != null);        
        
        EON_Site_Vulnerability__c siteVul1 = new EON_Site_Vulnerability__c();
        siteVul1.Premise__c = eSite.id; 
        siteVul1.Vulnerability_Type__c = 'C';
        siteVul1.Vulnerability_code__c = code.id;
        insert siteVul1;  
        
        ctrl.selectedVType = 'C';
        ctrl.selectedVCode = code.id;
        ctrl.saveRec();              
        

    }
    
    /**
        unitTest2() - unittest2
    **/
    public static testmethod void unitTet2(){
        EON_Site_Vul_Handler.UpdateSiteVulnerabilityAsDelete(null);
        
        EON_Region__c region = new EON_Region__c(GSP_ID__c =12);        
        insert region;
        EON_Shutdown_Days__c days = new EON_Shutdown_Days__c(Name='Bank holiday',Holiday_Date__c=System.today());
        insert days;
        EON_Customer__c eCust = EON_CreateTestRecords.createEONCustomer();
        insert eCust;
        EON_Site__c eSite =  new EON_Site__c(Customer__c=eCust.ID, Name = '1234567890',
                            Building_Name__c = 'Able Smith House',Building_Number__c = '1324654',
                            Address_Type__c = 'S',Country__c = null ,County__c = null,
                            Dependant_Locality__c = 'Stevenage',Dependant_Thorofare__c = 'Stevenage',
                            Double_Dependant_Locality__c = 'Stevenage',Sub_Building_Name__c = 'Stevenage',
                            Thorofare__c = 'Stevenage',Town__c = 'Stevenage');
        insert eSite;   
        
        EON_Vulnerability_Code__c code = new EON_Vulnerability_Code__c();
        code.Name = 'TEST';
        insert code;        
        
        EON_Site_Vulnerability__c siteVul = new EON_Site_Vulnerability__c();
        siteVul.Premise__c = eSite.id; 
        siteVul.Vulnerability_Type__c = 'C';
        siteVul.Vulnerability_code__c = code.id;
        insert siteVul;
        
        System.assert(EON_Site_Vul_Handler.UpdateSiteVulnerabilityAsDelete(siteVul.id) == 'SUCCESS');
                
        
    }    

}